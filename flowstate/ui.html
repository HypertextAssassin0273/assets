<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>FlowState</title>

<style>
body {
  margin:0;
  padding:10px;
  font-family:system-ui;
  background:#0e0e0e;
  color:#eee;
}

.group {
  display:flex;
  align-items:center;
  margin-bottom:6px;
}

button {
  margin-top:10px;
  width:100%;
  padding:6px;
  background:#2563eb;
  border:none;
  color:white;
  cursor:pointer;
}

button:disabled {
  opacity:0.4;
  cursor:not-allowed;
}

#empty {
  opacity:0.6;
  margin-bottom:10px;
}
</style>
</head>

<body>

<h3>Suspend Groups</h3>

<div id="empty" style="display:none;">
  No active tab groups found.
</div>

<div id="groups"></div>

<button id="suspend" disabled>Suspend Selected</button>

<script>
const groupsDiv = document.getElementById("groups");
const emptyMsg = document.getElementById("empty");
const suspendBtn = document.getElementById("suspend");

// Ask popup for groups
window.parent.postMessage({ type:"list-groups" }, "*");

// Receive groups
window.addEventListener("message", e => {
  if (e.data.type !== "groups") return;

  const groups = e.data.groups || [];
  groupsDiv.innerHTML = "";

  if (groups.length === 0) {
    emptyMsg.style.display = "block";
    suspendBtn.disabled = true;
    return;
  }

  emptyMsg.style.display = "none";

  groups.forEach(g => {
    const row = document.createElement("div");
    row.className = "group";
    row.innerHTML = `
      <input type="checkbox" value="${g.id}">
      <span style="margin-left:6px">${g.title || "(untitled)"}</span>
    `;
    groupsDiv.appendChild(row);
  });

  suspendBtn.disabled = false;
});

// Suspend selected groups
suspendBtn.onclick = () => {
  const ids = [...document.querySelectorAll("input:checked")].map(i => +i.value);
  if (!ids.length) return;
  window.parent.postMessage({ type:"suspend-groups", ids }, "*");
};
</script>

</body>
</html>
